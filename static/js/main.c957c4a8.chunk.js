(this["webpackJsonpreact-mesto-auth"]=this["webpackJsonpreact-mesto-auth"]||[]).push([[0],{31:function(e,t,n){},37:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n(1),i=n.n(c),s=n(20),o=n.n(s),r=n(9),l=(n(31),n(2)),u=n(3),d=n(5),p=n(25),j=function(e){var t=e.component,n=Object(p.a)(e,["component"]);return Object(a.jsx)(u.b,{children:function(){return n.loggedIn?Object(a.jsx)(t,Object(d.a)({},n)):Object(a.jsx)(u.a,{to:"./signin"})}})},b="https://auth.nomoreparties.co",m=function(e){return e.ok?e.json():Promise.reject(e.status)},h=n(24),_=i.a.createContext(),f=n.p+"static/media/header-logo.c2821b38.svg",O=function(e){return Object(a.jsxs)("header",{className:"header",children:[Object(a.jsx)("img",{className:"header__logo",src:f,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f \u0441\u0435\u0440\u0432\u0438\u0441\u0430 Mesto-Russia"}),Object(a.jsx)("nav",{className:"nav-menu",children:e.children})]})};var g=function(e){var t=e.card,n=e.onClick,i=e.onLike,s=e.onDelete,o=Object(c.useContext)(_),r=t.owner===o._id;return Object(a.jsxs)("li",{className:"card",children:[Object(a.jsx)("img",{className:"card__image",src:t.link,alt:t.title,onClick:function(){n(t)}}),Object(a.jsxs)("div",{className:"card__description",children:[Object(a.jsx)("h2",{className:"card__title",children:t.title}),Object(a.jsxs)("div",{className:"card__like-group",children:[Object(a.jsx)("button",{className:"card__btn card__btn_action_like shaded \n              ".concat(t.likes.length>0?"card__btn_clicked":""),onClick:function(){i(t)},title:"\u041d\u0440\u0430\u0432\u0438\u0442\u0441\u044f"}),Object(a.jsx)("span",{className:"card__like-num",children:t.likes.length})]})]}),Object(a.jsx)("button",{className:"card__btn card__btn_action_del shaded",disabled:!r,hidden:!r,onClick:function(){s(t)},title:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})]})},x=function(){return Object(a.jsx)("div",{className:"loader"})};var v=function(e){var t=Object(c.useContext)(_);return Object(a.jsxs)("main",{className:"content",children:[Object(a.jsxs)("section",{className:"profile",children:[Object(a.jsx)("div",{className:"profile__avatar",onClick:e.onEditAvatar,children:Object(a.jsx)("img",{src:t.avatar,className:"profile__image",alt:"\u0410\u0432\u0430\u0442\u0430\u0440 \u043f\u0440\u043e\u0444\u0438\u043b\u044f",title:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440 \u043f\u0440\u043e\u0444\u0438\u043b\u044f"})}),Object(a.jsxs)("div",{className:"profile__description",children:[Object(a.jsx)("h1",{className:"profile__name",children:t.name}),Object(a.jsx)("button",{className:"profile__btn profile__btn_action_edit shaded",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",onClick:e.onEditProfile}),Object(a.jsx)("p",{className:"profile__work",children:t.about})]}),Object(a.jsx)("button",{className:"profile__btn profile__btn_action_add shaded",onClick:e.onAddPlace,title:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0444\u043e\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u044e"})]}),Object(a.jsx)("section",{className:"photo-grid",children:e.isLoading?Object(a.jsx)(x,{}):Object(a.jsx)("ul",{className:"photo-grid__list",children:e.cards.map((function(t){return Object(a.jsx)(g,{card:t,onClick:e.onCardClick,onLike:e.onCardLike,onDelete:e.onCardDelete},t.id)}))})})]})},N=function(){return Object(a.jsx)("footer",{className:"footer",children:Object(a.jsx)("p",{className:"footer__copyright",children:"\xa9 2020 Mesto Russia"})})};var k=function(e){var t=e.isOpen&&"popup_opened",n=e.onClose,i=Object(c.useCallback)((function(e){"Escape"===e.key&&n()}),[n]);return Object(c.useEffect)((function(){e.isOpen?document.addEventListener("keyup",i):document.removeEventListener("keyup",i)}),[e.isOpen,i]),Object(a.jsx)("div",{className:"popup popup_content_".concat(e.name," ").concat(t),onClick:function(e){e.target===e.currentTarget&&n()},children:Object(a.jsxs)("div",{className:"popup__container",children:[Object(a.jsx)("button",{type:"button",className:"popup__btn popup__btn_action_close shaded",title:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c \u0444\u043e\u0440\u043c\u0443 \u0431\u0435\u0437 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445",onClick:n}),Object(a.jsxs)("form",{name:e.name,className:"popup__form popup__form_size_".concat(e.size),onSubmit:e.onSubmit,children:[Object(a.jsx)("h3",{className:"popup__heading",children:e.title}),e.children,Object(a.jsx)("button",{type:"submit",value:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",disabled:e.submitDisabled,className:"popup__btn popup__btn_action_submit",children:e.submitName})]})]})})},C="popup__item_type_error",y="popup__error_visible",S=n(10);function w(){var e=Object(c.useState)({}),t=Object(l.a)(e,2),n=t[0],a=t[1],i=Object(c.useState)({}),s=Object(l.a)(i,2),o=s[0],r=s[1],u=Object(c.useState)({}),p=Object(l.a)(u,2),j=p[0],b=p[1],m=Object(c.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];a(e),r(t),b(n)}),[a,r,b]);return{values:n,setValues:a,handleChange:function(e){var t=e.target,c=e.target,i=c.name,s=c.value;a(Object(d.a)(Object(d.a)({},n),{},Object(S.a)({},i,s))),b(t.closest("form").checkValidity())},handleInput:function(e){var t=e.target,c=t.name,i=t.value,s=t.validity,l=t.validationMessage;a(Object(d.a)(Object(d.a)({},n),{},Object(S.a)({},c,i))),b(Object(d.a)(Object(d.a)({},j),{},Object(S.a)({},c,s.valid))),r(Object(d.a)(Object(d.a)({},o),{},Object(S.a)({},c,l)))},errors:o,isValid:j,resetForm:m}}var L=function(e){var t=Object(c.useContext)(_),n=w(),i=n.values,s=n.handleChange,o=n.handleInput,r=n.errors,l=n.isValid,u=n.resetForm;return Object(c.useEffect)((function(){u(),e.isOpen&&u({name:t.name,info:t.about},{},!0)}),[t,e.isOpen,u]),Object(a.jsxs)(k,{name:"profile",size:"l",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",submitName:e.submitName,submitDisabled:!l,isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:i.name,info:i.info})},children:[Object(a.jsxs)("label",{className:"popup__field",children:[Object(a.jsx)("input",{type:"text",id:"name",name:"name",className:"\n            popup__item popup__item_type_name\n            ".concat(r.name?C:"","\n          "),maxLength:"40",minLength:"2",placeholder:"\u0418\u043c\u044f",required:!0,value:i.name||"",onChange:s,onInput:o}),Object(a.jsx)("span",{className:"popup__error ".concat(y),id:"name-error",children:r.name||""})]}),Object(a.jsxs)("label",{className:"popup__field",children:[Object(a.jsx)("input",{type:"text",id:"info",name:"info",className:"\n            popup__item popup__item_type_info\n            ".concat(r.info?C:"","\n          "),maxLength:"200",minLength:"2",placeholder:"\u041e \u0441\u0435\u0431\u0435",required:!0,value:i.info||"",onChange:s,onInput:o}),Object(a.jsx)("span",{className:"popup__error ".concat(y),id:"info-error",children:r.info||""})]})]})};var E=function(e){var t=Object(c.useContext)(_),n=w(),i=n.values,s=n.handleChange,o=n.handleInput,r=n.errors,l=n.isValid,u=n.resetForm;return Object(c.useEffect)((function(){e.isOpen?u({avatar:t.avatar},{},!0):u()}),[t,e.isOpen,u]),Object(a.jsx)(k,{name:"avatar",size:"m",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",submitName:e.submitName,submitDisabled:!l,isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onUpdateAvatar(i.avatar)},children:Object(a.jsxs)("label",{className:"popup__field",children:[Object(a.jsx)("input",{type:"url",id:"avatar",name:"avatar",pattern:"https?://.+",className:"popup__item popup__item_type_name\n            ".concat(r.avatar?C:""),placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0,value:i.avatar||"",onChange:s,onInput:o}),Object(a.jsx)("span",{className:"popup__error  ".concat(y),id:"avatar-error",children:r.avatar||""})]})})},U=function(e){var t=w(),n=t.values,i=t.handleChange,s=t.handleInput,o=t.errors,r=t.isValid,l=t.resetForm;Object(c.useEffect)((function(){l()}),[e.isOpen,l]);return Object(a.jsxs)(k,{name:"card",size:"l",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",submitName:e.submitName,submitDisabled:!r,isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onAddPlace(n)},children:[Object(a.jsxs)("label",{className:"popup__field",children:[Object(a.jsx)("input",{type:"text",id:"title",name:"title",maxLength:"30",minLength:"1",className:"popup__item popup__item_type_name\n            ".concat(o.title?C:""),placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",required:!0,value:n.title||"",onChange:i,onInput:s}),Object(a.jsx)("span",{className:"popup__error ".concat(y),id:"title-error",children:o.title||""})]}),Object(a.jsxs)("label",{className:"popup__field",children:[Object(a.jsx)("input",{type:"url",id:"link",name:"link",pattern:"https?://.+",className:"popup__item popup__item_type_info\n            ".concat(o.link?C:""),placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0,value:n.link||"",onChange:i,onInput:s}),Object(a.jsx)("span",{className:"popup__error ".concat(y),id:"link-error",children:o.link||""})]})]})};var I=function(e){var t=e.card,n=e.onClose,i=Object(c.useState)(""),s=Object(l.a)(i,2),o=s[0],r=s[1],u=function(){r(""),n()};return Object(c.useEffect)((function(){var e=function(e){"Escape"===e.key&&u()};return document.addEventListener("keyup",e),r("popup_opened"),function(){document.removeEventListener("keyup",e)}}),[]),Object(a.jsx)("div",{className:"popup popup_content_image ".concat(o),onClick:function(e){e.target===e.currentTarget&&u()},children:Object(a.jsxs)("div",{className:"popup__image-box",children:[Object(a.jsx)("button",{type:"button",className:"popup__btn popup__btn_action_close shaded",title:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c \u043e\u043a\u043d\u043e \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0430",onClick:u}),Object(a.jsxs)("figure",{className:"popup__figure",children:[Object(a.jsx)("img",{className:"popup__image",src:t.link,alt:t.title}),Object(a.jsx)("figcaption",{className:"popup__image-caption",children:t.title})]})]})})};var P=function(e){return Object(a.jsx)(k,{name:"confirm",size:"s",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",submitName:e.submitName,submitDisabled:!1,isOpen:e.card,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onConfirm(e.card)}})},D=n(22),T=n(23),A=new(function(){function e(t){var n=t.baseUrl,a=t.headers;Object(D.a)(this,e),this._baseUrl=n,this._headers=a}return Object(T.a)(e,[{key:"_handleResponse",value:function(e){return e.ok?e.json():Promise.reject(e.status)}},{key:"getUserInfo",value:function(){var e=this;return fetch("".concat(this._baseUrl,"/users/me"),{method:"GET",headers:this._headers}).then((function(t){return e._handleResponse(t)}))}},{key:"getInitialCards",value:function(){var e=this;return fetch("".concat(this._baseUrl,"/cards"),{method:"GET",headers:this._headers}).then((function(t){return e._handleResponse(t)}))}},{key:"postNewCard",value:function(e){var t=this;return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify(e)}).then((function(e){return t._handleResponse(e)}))}},{key:"patchNewAvatar",value:function(e){var t=this;return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then((function(e){return t._handleResponse(e)}))}},{key:"patchUserProfile",value:function(e){var t=this;return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.info})}).then((function(e){return t._handleResponse(e)}))}},{key:"likeCard",value:function(e){var t=this;return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:this._headers}).then((function(e){return t._handleResponse(e)}))}},{key:"unlikeCard",value:function(e){var t=this;return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:this._headers}).then((function(e){return t._handleResponse(e)}))}},{key:"deleteCard",value:function(e){var t=this;return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then((function(e){return t._handleResponse(e)}))}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-14",headers:{authorization:"963ba2cb-ffe5-4800-9828-03d0e9a57e68","Content-Type":"application/json"}}),R=n.p+"static/media/profile-avatar.5024594e.jpg",q=[{title:"\u041f\u0435\u0442\u0435\u0440\u0433\u043e\u0444",link:n.p+"static/media/photo-grid-peterhof-4.947a5379.jpg",likes:[],owner:0,id:1},{title:"\u041f\u0435\u0442\u0435\u0440\u0433\u043e\u0444",link:n.p+"static/media/photo-grid-peterhof-3.d5249dfb.jpg",likes:[],owner:0,id:2},{title:"\u041f\u0435\u0442\u0435\u0440\u0433\u043e\u0444",link:n.p+"static/media/photo-grid-peterhof-1.57bdf3c4.jpg",likes:[],owner:0,id:3},{title:"\u041e\u0440\u0430\u043d\u0438\u0435\u043d\u0431\u0430\u0443\u043c",link:n.p+"static/media/photo-grid-oranienbaum-1.48084ea7.jpg",likes:[],owner:0,id:4},{title:"\u041f\u0430\u0440\u043a \u0410\u043b\u0435\u043a\u0441\u0430\u043d\u0434\u0440\u0438\u044f",link:n.p+"static/media/photo-grid-aleksandria.504811f3.jpg",likes:[],owner:0,id:5},{title:"\u041f\u0435\u0442\u0435\u0440\u0433\u043e\u0444",link:n.p+"static/media/photo-grid-peterhof.8dd60d68.jpg",likes:[],owner:0,id:6}];var z=function(e){var t=Object(c.useState)({_id:0,name:"\u0415\u043a\u0430\u0442\u0435\u0440\u0438\u043d\u0430",about:"(\u0431\u0435\u0437 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u0432 \u0441\u0435\u0442\u044c)",avatar:R}),n=Object(l.a)(t,2),i=n[0],s=n[1],o=Object(c.useState)(q),r=Object(l.a)(o,2),u=r[0],p=r[1],j=Object(c.useState)(null),b=Object(l.a)(j,2),m=b[0],f=b[1],g=Object(c.useState)(null),x=Object(l.a)(g,2),k=x[0],C=x[1],y=Object(c.useState)(!1),S=Object(l.a)(y,2),w=S[0],D=S[1],T=Object(c.useState)(!1),z=Object(l.a)(T,2),J=z[0],M=z[1],V=Object(c.useState)(!1),F=Object(l.a)(V,2),G=F[0],B=F[1],H=Object(c.useState)("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),K=Object(l.a)(H,2),Q=K[0],W=K[1],X=Object(c.useState)("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),Y=Object(l.a)(X,2),Z=Y[0],$=Y[1],ee=Object(c.useState)("\u0421\u043e\u0437\u0434\u0430\u0442\u044c"),te=Object(l.a)(ee,2),ne=te[0],ae=te[1],ce=Object(c.useState)("\u0414\u0430"),ie=Object(l.a)(ce,2),se=ie[0],oe=ie[1],re=Object(c.useState)(!1),le=Object(l.a)(re,2),ue=le[0],de=le[1];return Object(c.useEffect)((function(){de(!0),Promise.all([A.getUserInfo(),A.getInitialCards()]).then((function(e){var t=Object(l.a)(e,2),n=t[0],a=t[1];s({_id:n._id,name:n.name,about:n.about,avatar:n.avatar}),p(a.map((function(e){return{title:e.name,link:e.link,likes:e.likes,owner:e.owner._id,id:e._id}})))})).catch((function(e){console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0434\u0430\u043d\u043d\u044b\u0445: ".concat(e,"."))})).finally((function(){de(!1)}))}),[]),Object(a.jsx)(_.Provider,{value:i,children:Object(a.jsxs)("div",{className:"page",children:[Object(a.jsxs)(O,{children:[Object(a.jsx)("p",{className:"nav-menu__text nav-menu__text_type_email",children:e.email}),Object(a.jsx)("p",{className:"nav-menu__text",onClick:e.onLogout,children:"\u0412\u044b\u0439\u0442\u0438"})]}),Object(a.jsx)(v,{onEditProfile:function(){return D(!0)},onAddPlace:function(){return M(!0)},onEditAvatar:function(){return B(!0)},onCardClick:function(e){return f(e)},onCardLike:function(e){var t=e.likes.some((function(e){return e._id===i._id})),n=t?"\u0443\u0434\u0430\u043b\u0438\u0442\u044c":"\u043f\u043e\u0441\u0442\u0430\u0432\u0438\u0442\u044c";(t?function(e){return A.unlikeCard(e)}:function(e){return A.likeCard(e)})(e.id).then((function(t){var n={title:t.name,link:t.link,likes:t.likes,owner:t.owner._id,id:t._id},a=u.map((function(t){return t.id===e.id?n:t}));p(a)})).catch((function(e){console.log("\u041d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e ".concat(n," \u043b\u0430\u0439\u043a. \u041e\u0448\u0438\u0431\u043a\u0430 ").concat(e,"."))}))},onCardDelete:function(e){C(e)},cards:u,isLoading:ue}),Object(a.jsx)(N,{}),m&&Object(a.jsx)(I,{card:m,onClose:function(){return f(null)}}),Object(a.jsx)(L,{submitName:Q,isOpen:w,onUpdateUser:function(e){var t=e.name,n=e.info;W("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435..."),A.patchUserProfile({name:t,info:n}).then((function(e){console.log("\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0430."),s(Object(d.a)(Object(d.a)({},i),{},{name:e.name,about:e.about})),D(!1)})).catch((function(e){console.log("\u041d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435. ".concat(e,"."))})).finally((function(){W("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")}))},onClose:function(){return D(!1)}}),Object(a.jsx)(E,{submitName:Z,isOpen:G,onUpdateAvatar:function(e){$("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435..."),A.patchNewAvatar({avatar:e}).then((function(e){s(Object(d.a)(Object(d.a)({},i),{},{avatar:e.avatar})),B(!1)})).catch((function(e){console.log("\u041d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435. ".concat(e,"."))})).finally((function(){$("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")}))},onClose:function(){return B(!1)}}),Object(a.jsx)(U,{submitName:ne,isOpen:J,onAddPlace:function(e){ae("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435..."),A.postNewCard({name:e.title,link:e.link}).then((function(e){var t={title:e.name,link:e.link,likes:e.likes,owner:e.owner._id,id:e._id};p([t].concat(Object(h.a)(u))),M(!1)})).catch((function(e){console.log("\u041d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0443 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435. \u041e\u0448\u0438\u0431\u043a\u0430 ".concat(e,"."))})).finally((function(){ae("\u0421\u043e\u0437\u0434\u0430\u0442\u044c")}))},onClose:function(){return M(!1)}}),Object(a.jsx)(P,{submitName:se,card:k,onConfirm:function(e){oe("\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435..."),A.deleteCard(e.id).then((function(t){var n=u.filter((function(t){return t.id!==e.id}));p(n),console.log("\u041a\u0430\u0440\u0442\u043e\u0447\u043a\u0430 ".concat(e.id," \u0443\u0434\u0430\u043b\u0435\u043d\u0430.")),C(null)})).catch((function(e){console.log("\u041d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0443. \u041e\u0448\u0438\u0431\u043a\u0430 ".concat(e,"."))})).finally((function(){oe("\u0414\u0430")}))},onClose:function(){return C(null)}})]})})},J=function(e){var t=Object(c.useState)(""),n=Object(l.a)(t,2),i=n[0],s=n[1],o=Object(c.useState)(""),u=Object(l.a)(o,2),d=u[0],p=u[1],j=function(){s(""),p("")};return Object(a.jsxs)("div",{className:"page",children:[Object(a.jsx)(O,{children:Object(a.jsx)(r.b,{to:"/signup",className:"nav-menu__link",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"})}),Object(a.jsx)("section",{className:"sign",children:Object(a.jsxs)("form",{name:"form-login",className:"sign__form",onSubmit:function(t){t.preventDefault(),i&&d&&e.onLogin(i,d,j)},children:[Object(a.jsx)("h3",{className:"sign__heading",children:"\u0412\u0445\u043e\u0434"}),Object(a.jsx)("label",{children:Object(a.jsx)("input",{type:"email",id:"email",name:"email",className:"sign__item",maxLength:"40",minLength:"2",placeholder:"Email",required:!0,value:i,onChange:function(e){s(e.target.value)}})}),Object(a.jsx)("label",{children:Object(a.jsx)("input",{type:"password",id:"password",name:"password",className:"sign__item",maxLength:"20",minLength:"6",placeholder:"Password",required:!0,value:d,onChange:function(e){p(e.target.value)}})}),Object(a.jsx)("button",{type:"submit",className:"sign__button",children:"\u0412\u043e\u0439\u0442\u0438"}),Object(a.jsxs)("p",{className:"sign__text",children:["\u0415\u0449\u0435 \u043d\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b?",Object(a.jsx)(r.b,{to:"/signup",className:"sign__link",children:" \u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"})]})]})})]})},M=function(e){var t=Object(c.useState)(""),n=Object(l.a)(t,2),i=n[0],s=n[1],o=Object(c.useState)(""),u=Object(l.a)(o,2),d=u[0],p=u[1],j=function(){s(""),p("")};return Object(a.jsxs)("div",{className:"page",children:[Object(a.jsx)(O,{children:Object(a.jsx)(r.b,{to:"/signin",className:"nav-menu__link",children:"\u0412\u043e\u0439\u0442\u0438"})}),Object(a.jsx)("section",{className:"sign",children:Object(a.jsxs)("form",{name:"form-register",className:"sign__form",onSubmit:function(t){t.preventDefault(),i&&d&&e.onRegister(i,d,j)},children:[Object(a.jsx)("h3",{className:"sign__heading",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(a.jsx)("label",{children:Object(a.jsx)("input",{type:"email",id:"email",name:"email",className:"sign__item",maxLength:"40",minLength:"2",placeholder:"Email",required:!0,value:i,onChange:function(e){s(e.target.value)}})}),Object(a.jsx)("label",{children:Object(a.jsx)("input",{type:"password",id:"password",name:"password",className:"sign__item",maxLength:"20",minLength:"6",placeholder:"Password",required:!0,value:d,onChange:function(e){p(e.target.value)}})}),Object(a.jsx)("button",{type:"submit",className:"sign__button",children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"}),Object(a.jsxs)("p",{className:"sign__text",children:["\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b?",Object(a.jsx)(r.b,{to:"/signin",className:"sign__link",children:" \u0412\u043e\u0439\u0442\u0438"})]})]})})]})},V=function(){return Object(a.jsxs)("div",{className:"page",children:[Object(a.jsx)(O,{}),Object(a.jsxs)("section",{className:"not-found",children:[Object(a.jsx)("h3",{className:"not-found__title",children:"\u041e\u0448\u0438\u0431\u043a\u0430 404"}),Object(a.jsx)("p",{className:"not-found__subtitle",children:"\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430"})]})]})},F=function(e){var t=Object(c.useState)(""),n=Object(l.a)(t,2),i=n[0],s=n[1];return Object(c.useEffect)((function(){s("popup_opened")}),[]),Object(a.jsx)("div",{className:"popup ".concat(i),children:Object(a.jsxs)("div",{className:"popup__container",children:[Object(a.jsx)("button",{type:"button",className:"popup__btn popup__btn_action_close shaded",title:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c \u0444\u043e\u0440\u043c\u0443",onClick:function(){s(""),e.onClose()}}),Object(a.jsxs)("div",{className:"popup__message-box",children:[Object(a.jsx)("img",{className:"popup__message-icon",src:e.imageLink,alt:e.textMessage}),Object(a.jsx)("p",{className:"popup__message-text",children:e.textMessage})]})]})})},G=n.p+"static/media/reg-success.a9eb6caf.svg",B=n.p+"static/media/reg-failure.d4ce2a26.svg",H=function(){var e=Object(c.useState)(!1),t=Object(l.a)(e,2),n=t[0],s=t[1],o=Object(c.useState)(!1),r=Object(l.a)(o,2),d=r[0],p=r[1],h=Object(c.useState)({image:null,text:""}),_=Object(l.a)(h,2),f=_[0],O=_[1],g=Object(c.useState)(""),x=Object(l.a)(g,2),v=x[0],N=x[1],k=Object(u.g)(),C=function(){if(localStorage.getItem("jwt")){var e=localStorage.getItem("jwt");(t=e,fetch("".concat(b,"/users/me"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)}}).then((function(e){return m(e)}))).then((function(e){e&&(N(e.data.email),s(!0),k.push("/home"))})).catch((function(e){console.log("\u041f\u0435\u0440\u0435\u0434\u0430\u043d\u043d\u044b\u0439 \u0442\u043e\u043a\u0435\u043d \u043d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u0435\u043d."),s(!1)}))}var t};Object(c.useEffect)((function(){C()}),[n]);return Object(a.jsxs)(i.a.Fragment,{children:[Object(a.jsxs)(u.d,{children:[Object(a.jsx)(j,{path:"/home",loggedIn:n,component:z,onLogout:function(){localStorage.removeItem("jwt"),s(!1)},email:v}),Object(a.jsx)(u.b,{path:"/signin",children:Object(a.jsx)(J,{onLogin:function(e,t,n){(function(e,t){return fetch("".concat(b,"/signin"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return m(e)}))})(e,t).then((function(e){e.token&&(localStorage.setItem("jwt",e.token),n(),k.push("/home"),s(!0))})).catch((function(t){var n="",a=B;switch(t){case 400:n="\u041e\u0448\u0438\u0431\u043a\u0430 400, \u043d\u0435 \u043f\u0435\u0440\u0435\u0434\u0430\u043d\u043e \u043e\u0434\u043d\u043e \u0438\u0437 \u043f\u043e\u043b\u0435\u0439";break;case 401:n="\u041e\u0448\u0438\u0431\u043a\u0430 401, \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c ".concat(e," \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d");break;default:n="\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437."}O({image:a,text:n}),console.log(n),p(!0)}))},history:k,email:v})}),Object(a.jsx)(u.b,{path:"/signup",children:Object(a.jsx)(M,{onRegister:function(e,t,n){var a="",c=null;(function(e,t){return fetch("".concat(b,"/signup"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return m(e)}))})(e,t).then((function(e){n(),k.push("/signin"),a="\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!",c=G})).catch((function(e){switch(e){case 400:a="\u041e\u0448\u0438\u0431\u043a\u0430 400, \u043d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u043e \u043e\u0434\u043d\u043e \u0438\u0437 \u043f\u043e\u043b\u0435\u0439",c=B;break;default:a="\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437.",c=B}})).finally((function(){O({image:c,text:a}),console.log(a),p(!0)}))},history:k})}),Object(a.jsx)(u.b,{exact:!0,path:"/",children:n?Object(a.jsx)(u.a,{to:"/home"}):Object(a.jsx)(u.a,{to:"/signin"})}),Object(a.jsx)(u.b,{path:"/react-mesto-auth",children:n?Object(a.jsx)(u.a,{to:"/home"}):Object(a.jsx)(u.a,{to:"/signin"})}),Object(a.jsx)(u.b,{path:"*",children:Object(a.jsx)(V,{})})]}),d&&Object(a.jsx)(F,{onClose:function(){p(!1)},imageLink:f.image,textMessage:f.text})]})};o.a.render(Object(a.jsx)(i.a.StrictMode,{children:Object(a.jsx)(r.a,{children:Object(a.jsx)(H,{})})}),document.getElementById("root"))}},[[37,1,2]]]);
//# sourceMappingURL=main.c957c4a8.chunk.js.map